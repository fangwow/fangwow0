<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="keywords" content="hexo,个人博客,blog">
  <meta name="description" content="个人博客">
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <link rel="dns-prefetch" href="https://busuanzi.ibruce.info">
  
  <link rel="dns-prefetch" href="https://widget.daovoice.io">
  <link rel="dns-prefetch" href="https://widget-static-cdn.daovoice.io">
  <link rel="dns-prefetch" href="https://im.daovoice.io">
  
  
  <link rel="dns-prefetch" href="https://hm.baidu.com/">
  
  
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://api.github.com">
  <link rel="dns-prefetch" href="https://avatars3.githubusercontent.com">
  
  <link rel="stylesheet" type="text/css" href="/songfang0/./style/main.d9e3dd.css">
	<link rel="shortcut icon" href="/favicon.ico" title="Favicon">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
	<title>移动端项目</title>
  
  <script>var _hmt=_hmt||[];(function(){var hm=document.createElement("script");hm.src="https://hm.baidu.com/hm.js?awwssw1snsnsnn1ndndnndnd99j";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();
  </script>
  
  
    <script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/123456.js","daovoice");daovoice('init',{app_id: "123456"});daovoice('update');
  </script>
  
</head>
<body>
<canvas id="pattern-placeholder" height="230"></canvas>
<div class="navbar-header">
  <a class="blog-title" href="/songfang0/">web前端总结</a>
  <a class="face-img" href="/songfang0/">
    <img src="https://tse1-mm.cn.bing.net/th?id=OIP.Wo0E2kACycBZa4AF_UoUjwAAAA&amp;w=97&amp;h=100&amp;c=8&amp;rs=1&amp;qlt=90&amp;pid=3.1&amp;rm=2">
  </a>
</div>
<main>
  <div class="article-title">
    
  
  <h1 class="title">
    移动端项目
  </h1>
  


    <ul class="article-info">
      <li>
        发布
        <time datetime="2019-04-18T14:48:32.000Z" itemprop="datePublished">2019-04-18</time>
      </li>
      <li>
        
    更新 <time datetime="2019-11-08T08:55:38.308Z" itemprop="dateUpdated">2019-11-08</time>

      </li>
      <li id="busuanzi_container_page_pv">
        阅读 <span id="busuanzi_value_page_pv"></span>
      </li>
    </ul>
  </div>
  <div class="container">
    <div class="article">
      <div class="content">
        
        <h1 id="项目总结"><a href="#项目总结" class="headerlink" title="项目总结"></a>项目总结</h1><h2 id="1-配置前端服务器"><a href="#1-配置前端服务器" class="headerlink" title="1. 配置前端服务器"></a>1. 配置前端服务器</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">配置Apache</span><br><span class="line">配置域名：</span><br><span class="line">	PHPStudy</span><br><span class="line">	其他选项菜单=&gt;站点域名管理=&gt;网站域名 网站根目录 第二域名 网站端口可不写 新增 保存并生成 </span><br><span class="line">	修改host文件配置域名： </span><br><span class="line">		其他选项菜单=&gt;打开host=&gt;localhost www.xxx.com</span><br><span class="line">		或者打开C盘目录,windows/system32/extc/hosts</span><br></pre></td></tr></table></figure>
<h2 id="2-配置后端服务器"><a href="#2-配置后端服务器" class="headerlink" title="2. 配置后端服务器"></a>2. 配置后端服务器</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">见文档</span><br><span class="line">前端地址：http://www.xxx.com</span><br><span class="line">后端地址：http://localhost:3030</span><br></pre></td></tr></table></figure>
<h2 id="3-后端接口跨域问题"><a href="#3-后端接口跨域问题" class="headerlink" title="3. 后端接口跨域问题"></a>3. 后端接口跨域问题</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">修改API文档中的app.js文件中,去除注释</span><br><span class="line">	app.all(&apos;*&apos;,function(req,res,next)&#123;</span><br><span class="line">        res.header(&apos;Access-Control-Allow-Origin&apos;,&apos;*&apos;);</span><br><span class="line">        next();</span><br><span class="line">	&#125;);</span><br><span class="line">	重启node ,输入两次^C，退出node,再次输入npm start,重新启动node</span><br></pre></td></tr></table></figure>
<h2 id="4-登录问题"><a href="#4-登录问题" class="headerlink" title="4. 登录问题"></a>4. 登录问题</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">user/login.html</span><br><span class="line">添加form表单，修改按钮，发送ajax请求</span><br><span class="line">步骤：</span><br><span class="line">	1.引入jquery.js文件</span><br><span class="line">	2.实现登录功能</span><br><span class="line">		2.1 获取用户输入表单的信息</span><br><span class="line">		2.2 将信息通过ajax请求发送到服务器端</span><br><span class="line">		2.3 等待服务器端的响应结果，处理登录后的逻辑</span><br><span class="line"></span><br><span class="line">	接收地址中的url参数，将?号及?号后面的内容提取出来</span><br><span class="line">	var search = location.search.slice(1);</span><br><span class="line">	var reg = /url=(.+)/;</span><br><span class="line">	利用正则表达式来匹配url地址</span><br><span class="line">	var match = reg.exec(search);</span><br><span class="line">	var url = match &amp;&amp; match[1];</span><br><span class="line">	如果有url地址则跳转到该地址，如果没有则跳转到Index.html页面</span><br><span class="line">	url = url || &apos;/&apos;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	$(&apos;form&apos;).on(&apos;submit&apos;,function()&#123;</span><br><span class="line">        var data = $(this).serialize();</span><br><span class="line">        console.log(data);  username=xxx&amp;password=123456;</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            // url:&apos;http://localhost:3000/user/login&apos;,</span><br><span class="line">            反向代理</span><br><span class="line">            url:&apos;http://58.com/api/user/login&apos;,   可以被简写为 &apos;/api/user/login&apos;</span><br><span class="line">            访问api就是访问localhost:3000,不会出现跨域问题</span><br><span class="line">            type:&apos;post&apos;,</span><br><span class="line">            data:data,    对象|字符串都可以</span><br><span class="line">            success:function(info)&#123;</span><br><span class="line">                console.log(info);</span><br><span class="line">                location.href = &apos;url&apos;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        由于使用ajax发送请求，不需要刷新，所以取消默认跳转功能</span><br><span class="line">        return false;  |e.preventDefault(); | e.cancelBubble = true;</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">密码是md5加密的；</span><br><span class="line">serialize()：jquery的方法获取表单数据  返回数据是value=key&amp;value2=key2格式的</span><br></pre></td></tr></table></figure>
<h3 id="4-1-查询用户信息-cookie跨域"><a href="#4-1-查询用户信息-cookie跨域" class="headerlink" title="4.1 查询用户信息(cookie跨域)"></a>4.1 查询用户信息(cookie跨域)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">user/index.html   会员中心 </span><br><span class="line">引入jquery.js文件</span><br><span class="line">步骤：</span><br><span class="line">	获取用户信息</span><br><span class="line">	1.发送请求获取用户信息</span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">        // url:&apos;http://localhost:3000/user/queryUserMessage&apos;,  出现跨域问题，使用反向代理实现跨域</span><br><span class="line">        url:&apos;http://58.com/api/user/queryUserMessage&apos;,  简写为 url:&apos;/api/user/queryUserMessage&apos;,</span><br><span class="line">        type:&apos;get&apos;,   参数无</span><br><span class="line">        success:function(info)&#123;</span><br><span class="line">            console.log(info);  无法获取已登录信息，因为跨域限制了cookie</span><br><span class="line">            根据响应结果判断是否登录</span><br><span class="line">            if(info.error)&#123;</span><br><span class="line">                location.href = &apos;/user/login.html&apos;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">注意：</span><br><span class="line">	跨域不但限制了XMLHttpRequest(即ajax)也限制了cookie。</span><br><span class="line">	CORS中设置的Access-Control-Allow-Origin:*只是用来解决XMLHttpRequest的跨域限制的，并不能解决cookie的跨域问题。</span><br></pre></td></tr></table></figure>
<h3 id="4-2-配置Apache的反向代理"><a href="#4-2-配置Apache的反向代理" class="headerlink" title="4.2 配置Apache的反向代理"></a>4.2 配置Apache的反向代理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">通过配置apache可以实现代理访问nodejs服务器</span><br><span class="line">配置apache：</span><br><span class="line">	1.phpstudy中=&gt;其他选项菜单=&gt;打开配置文件=&gt;vhosts-conf </span><br><span class="line">	proxyRequests Off  关闭正向代理</span><br><span class="line">	proxyPass /api  http://localhost:3000  如果访问的地址是/api开头 代理到localhost:3000</span><br><span class="line">	2.phpstudy中=&gt;其他选项菜单=&gt;打开配置文件=&gt;httpd-conf</span><br><span class="line">	LoadModule proxy_module modules/mod_proxy.so  解开注释</span><br><span class="line">	LoadModule proxy_http_module modules/mod_proxy_http.so  解开注释</span><br><span class="line">	重新启动PHPStudy</span><br></pre></td></tr></table></figure>
<h3 id="4-3-退出登录"><a href="#4-3-退出登录" class="headerlink" title="4.3 退出登录"></a>4.3 退出登录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">通过git实现,下载代码到目录，创建新分支，并切换到该分支 feature-user</span><br><span class="line">index.html</span><br><span class="line">点击退出按钮，跳转到登录页面</span><br><span class="line">步骤：</span><br><span class="line">	1.添加点击事件</span><br><span class="line">	2.发送请求</span><br><span class="line">	3.等待后端响应</span><br><span class="line">	4.处理响应的逻辑</span><br><span class="line">	$(&apos;.btn_outLogin&apos;).on(&apos;click&apos;,function()&#123;</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            url:&apos;/api/user/logout&apos;,</span><br><span class="line">            type:&apos;get&apos;,    不需要参数</span><br><span class="line">            success:function(info)&#123;</span><br><span class="line">                console.log(info);</span><br><span class="line">                if(info.success)&#123;</span><br><span class="line">                    location.href = &apos;/index.html&apos;;  &apos;/&apos;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="4-4-优化登录"><a href="#4-4-优化登录" class="headerlink" title="4.4   优化登录"></a>4.4   优化登录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">address.html</span><br><span class="line">从哪个页面点击到登录页面，登录之后再跳转到原来的页面</span><br><span class="line">跳转到登录页面时,传入参数url记录当前传入的是哪个地址，</span><br><span class="line">if(info.error) return location.href= &apos;/user/login.html?url=&apos;+location.href;</span><br><span class="line"></span><br><span class="line">login.html</span><br><span class="line">获取地址参数，如果有url参数，登录成功后跳转到url参数所对应的地址，如果没有url参数，则默认跳转到首页。</span><br><span class="line">location.search:  获取的是url地址后面 ？号及？号后面的内容</span><br><span class="line">var search = location.search.slice(1);   从下标为1的地方开始截取，截取到结尾。</span><br><span class="line">search:url=location.href</span><br><span class="line">通过正则表达式获取地址中的参数</span><br><span class="line">var reg = /url=(.+)/;</span><br><span class="line">var match = reg.exec(search);</span><br><span class="line">var url = match &amp;&amp; match[1];</span><br><span class="line">url = url || &apos;/&apos;;</span><br></pre></td></tr></table></figure>
<h2 id="4-用户注册"><a href="#4-用户注册" class="headerlink" title="4. 用户注册"></a>4. 用户注册</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">register.html</span><br><span class="line">引入jquery.js文件</span><br><span class="line">步骤：</span><br><span class="line">	修改html文件，添加form表单，修改注册a链接为button按钮</span><br><span class="line">	1.获取表单中用户填写的信息</span><br><span class="line">	2.发送这些信息</span><br><span class="line">	3.等待后端响应结果</span><br><span class="line">	4.处理响应的逻辑</span><br><span class="line">	$(&apos;form&apos;).on(&apos;submit&apos;,function()&#123;</span><br><span class="line">		获取表单中用户填写的信息,serialize方法会自动忽略没有name的表单信息，如果不需要确认密码，那么可以把确认密码的name属性去掉</span><br><span class="line">	    var data = $(this).serialize();</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            url:&apos;/api/user/register&apos;,</span><br><span class="line">            type:&apos;post&apos;,</span><br><span class="line">            data:data,</span><br><span class="line">            success:funtion(info)&#123;</span><br><span class="line">                console.log(info);</span><br><span class="line">                if(info.success)&#123;</span><br><span class="line">                    location.href = &apos;/user/login.html&apos;;</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                错误提示</span><br><span class="line">                alert(info.message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        阻止表单默认提交</span><br><span class="line">        return false;</span><br><span class="line">	&#125;);</span><br><span class="line">	</span><br><span class="line">	获取验证码</span><br><span class="line">	步骤：</span><br><span class="line">		1.点击事件</span><br><span class="line">		2.发送请求</span><br><span class="line">		3.等待服务端响应结果</span><br><span class="line">		4.处理相应的逻辑</span><br><span class="line">	$(&apos;.btn_getCode&apos;).on(&apos;click&apos;,function()&#123;</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            url:&apos;/api/user/vCode&apos;,</span><br><span class="line">            type:&apos;get&apos;,   参数无</span><br><span class="line">            success:function(info)&#123;</span><br><span class="line">                console.log(info);</span><br><span class="line">               </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="4-1-修改密码"><a href="#4-1-修改密码" class="headerlink" title="4.1 修改密码"></a>4.1 修改密码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">password.html</span><br><span class="line">引入jquery.js文件，添加form表单，修改按钮a链接为button</span><br><span class="line">步骤：</span><br><span class="line">	1.获取表单信息</span><br><span class="line">	2.发送表单信息</span><br><span class="line">	3.等待服务器响应结果</span><br><span class="line">	4.处理相关业务逻辑</span><br><span class="line">	$(&apos;form&apos;).on(&apos;submit&apos;,function()&#123;</span><br><span class="line">		获取表单中用户填写的信息,serialize方法会自动忽略没有name的表单信息，如果不需要确认密码，那么可以把确认密码的name属性去掉</span><br><span class="line">	    var data = $(this).serialize();</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            url:&apos;/api/user/updatePassword&apos;,</span><br><span class="line">            type:&apos;post&apos;, </span><br><span class="line">            data:data,</span><br><span class="line">            success:funtion(info)&#123;</span><br><span class="line">                console.log(info);</span><br><span class="line">                if(info.success)&#123;</span><br><span class="line">                    location.href = &apos;/user/login.html&apos;;</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                错误提示</span><br><span class="line">                alert(info.message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        阻止表单默认提交</span><br><span class="line">        return false;</span><br><span class="line">	&#125;);</span><br><span class="line">	</span><br><span class="line">获取验证码</span><br><span class="line">	步骤：</span><br><span class="line">		1.点击事件</span><br><span class="line">		2.发送请求</span><br><span class="line">		3.等待服务端响应结果</span><br><span class="line">		4.处理相应的逻辑</span><br><span class="line">	$(&apos;.btn_getCode&apos;).on(&apos;click&apos;,function()&#123;</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            url:&apos;/api/user/vCodeForUpdatePassword&apos;,</span><br><span class="line">            type:&apos;get&apos;,   参数无</span><br><span class="line">            success:function(info)&#123;</span><br><span class="line">                console.log(info);</span><br><span class="line">               </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">用户模块完成</span><br><span class="line">git status</span><br><span class="line">git add -A</span><br><span class="line">git commit -m &quot;用户模块完成，等待测试&quot;      确定分支，和修改的文件，</span><br><span class="line">将代码发送到远程仓库上的feature-user分支上</span><br><span class="line">git push origin feature-user</span><br><span class="line">创建新的分支，首先先切换到主分支master，再创建新分支，因为原来的feature-user分支还没测试完毕。</span><br><span class="line">git checkout master</span><br><span class="line">git checkout -b feature-address</span><br></pre></td></tr></table></figure>
<h2 id="5-收货地址列表"><a href="#5-收货地址列表" class="headerlink" title="5. 收货地址列表"></a>5. 收货地址列表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">git checkout feature-address</span><br><span class="line">user/address.html</span><br><span class="line">引入jquery.js文件，引入模板引擎template-web.js文件</span><br><span class="line">获取地址列表</span><br><span class="line">	步骤:</span><br><span class="line">		1.发送ajax请求</span><br><span class="line">		2.等待服务器响应</span><br><span class="line">		3.处理数据</span><br><span class="line">		$.ajax(&#123;</span><br><span class="line">            url:&apos;/api/address/queryAddress&apos;,</span><br><span class="line">            type:&apos;get&apos;,               参数无,修改文档参数为无。</span><br><span class="line">            success:function(info)&#123;</span><br><span class="line">                console.log(info);</span><br><span class="line">                if(info.error)&#123;</span><br><span class="line">                    location.href = &quot;/user/login.html?url=&quot;+location.href;</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                可以简写为：</span><br><span class="line">                if(info.error) return location.href=&quot;/user/login.html?url=&quot;+location.href;</span><br><span class="line">                处理数据使用模板引擎</span><br><span class="line">                调用模板引擎</span><br><span class="line">                var html = template(&apos;template&apos;,&#123;lists:info&#125;);</span><br><span class="line">                $(&apos;ul&apos;).html(html);</span><br><span class="line">            &#125;</span><br><span class="line">		&#125;);</span><br><span class="line">		</span><br><span class="line">模板引擎：</span><br><span class="line">	定义模板</span><br><span class="line">	&lt;script type=&quot;text/html&quot; id=&quot;template&quot;&gt;</span><br><span class="line">		&#123;&#123;each lists value&#125;&#125;</span><br><span class="line">			&lt;li class=&quot;mui-table-view-cell&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;mui-slider-right mui-disabled&quot;&gt;</span><br><span class="line">                    &lt;a class=&quot;mui-btn mui-btn-red&quot; data-id=&apos;&#123;&#123;value.id&#125;&#125;&apos;&gt;删除&lt;/a&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;a href=&quot;addressManage.html&quot; class=&quot;mui-navigate-right mui-slider-handle&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;delivery&quot;&gt;邮编：&lt;span&gt;&#123;&#123;value.postCode&#125;&#125;&lt;/span&gt;&amp;nbsp;收货人：&lt;span&gt;&#123;&#123;value.recipients&#125;&#125;&lt;/span&gt;&lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;address&quot;&gt;&#123;&#123;value.address&#125;&#125;&#123;&#123;value.addressDetail&#125;&#125;&lt;/div&gt;</span><br><span class="line">                &lt;/a&gt;</span><br><span class="line">            &lt;/li&gt;</span><br><span class="line">		&#123;&#123;/each&#125;&#125;	</span><br><span class="line">	&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="6-添加地址"><a href="#6-添加地址" class="headerlink" title="6. 添加地址"></a>6. 添加地址</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">1)在address.html页面添加添加地址按钮</span><br><span class="line">&lt;style&gt;</span><br><span class="line">	.add_btn &#123;</span><br><span class="line">        padding: 0 30px;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;div class=&quot;add_btn&quot;&gt;</span><br><span class="line">	&lt;a href=&quot;/user/addAddress.html&quot; type=&quot;submit&quot; class=&quot;mui-btn mui-btn-primary btn-login&quot;&gt;新增地址&lt;/a&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">2)给列表添加a链接，跳转到修改页面</span><br><span class="line">3)添加form表单，修改提交按钮</span><br><span class="line"></span><br><span class="line">新增地址</span><br><span class="line">步骤：</span><br><span class="line">	1.获取表单数据</span><br><span class="line">	2.发送数据到服务端</span><br><span class="line">	3.等待服务器响应结果</span><br><span class="line">	4.处理响应逻辑</span><br><span class="line">	$(&apos;form&apos;).on(&apos;submit&apos;,function()&#123;</span><br><span class="line">        获取表单数据</span><br><span class="line">        var data = $(this).serialize();</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            url:&apos;/api/address/addAddress&apos;,</span><br><span class="line">            type:&apos;post&apos;,</span><br><span class="line">            data:data,</span><br><span class="line">            success:function(info)&#123;</span><br><span class="line">                console.log(info);</span><br><span class="line">                if(info.success)&#123;</span><br><span class="line">                    location.href = &apos;/user/address.html&apos;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        阻止默认跳转</span><br><span class="line">        return false;</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="6-1-删除地址"><a href="#6-1-删除地址" class="headerlink" title="6.1 删除地址"></a>6.1 删除地址</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">不能直接给删除按钮绑定点击事件，因为地址列表是由模板引擎渲染来的，当点击按钮的时候，ajax还没渲染完，所以需要事件委托来绑定事件。</span><br><span class="line">$(&apos;#address&apos;).on(&apos;click&apos;,&apos;.mui-btn-red&apos;,function()&#123;</span><br><span class="line">	var id = $(this).attr(&apos;data-id&apos;);</span><br><span class="line">	var _this = $(this);</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url:&apos;/api/address/deleteAddress&apos;,</span><br><span class="line">        type:&apos;post&apos;,</span><br><span class="line">        data:&#123;id:id&#125;,</span><br><span class="line">        success:function(info)&#123;</span><br><span class="line">            console.log(info);</span><br><span class="line">            if(info.success)&#123;</span><br><span class="line">                这里面的this是ajax里面的this</span><br><span class="line">                //  _this.parent().parent().parent();</span><br><span class="line">                //  parents();  获取祖先的方法,获取祖先中的li父元素</span><br><span class="line">                _this.parents(&apos;li&apos;).fadeOut(function()&#123;</span><br><span class="line">                    $(this).remove();</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="7-商品列表"><a href="#7-商品列表" class="headerlink" title="7.  商品列表"></a>7.  商品列表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">index.html</span><br><span class="line">引入模板引擎</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url:&apos;/api/product/queryProduct&apos;,</span><br><span class="line">    type:&apos;get&apos;,</span><br><span class="line">    data:&#123;</span><br><span class="line">    	page: 1,</span><br><span class="line">    	pageSize:6</span><br><span class="line">    &#125;,</span><br><span class="line">    success:function(info)&#123;</span><br><span class="line">        console.log(info);</span><br><span class="line">        调用模板引擎</span><br><span class="line">        var html = template(&apos;template&apos;,info);</span><br><span class="line">        $(&apos;#product&apos;).html(html);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">模板引擎</span><br><span class="line">&lt;script type=&apos;text/template&apos; id=&apos;template&apos;&gt;</span><br><span class="line">	&#123;&#123;each data value&#125;&#125;</span><br><span class="line">		&lt;a href=&quot;/product.html?id=&#123;&#123;value.id&#125;&#125;&quot; class=&quot;cz_product&quot;&gt;</span><br><span class="line">	         &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">	                &lt;img src=&quot;/api&#123;&#123;value.pic[0].picAddr&#125;&#125;&quot; alt=&quot;&quot;/&gt;</span><br><span class="line">	                &lt;p class=&quot;name&quot;&gt;&#123;&#123;value.proName&#125;&#125;&lt;/p&gt;</span><br><span class="line">	                &lt;p&gt;&lt;span class=&quot;price&quot;&gt;&amp;yen;&#123;&#123;value.price&#125;&#125;&lt;/span&gt;&lt;span class=&quot;oldPrice&quot;&gt;&amp;yen;&#123;&#123;value.oldPrice&#125;&#125;&lt;/span&gt;&lt;/p&gt;</span><br><span class="line">	                &lt;button class=&quot;button&quot;&gt;立即购买&lt;/button&gt;</span><br><span class="line">	         &lt;/div&gt;</span><br><span class="line">		&lt;/a&gt;</span><br><span class="line">	&#123;&#123;/each&#125;&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="7-1-商品详情"><a href="#7-1-商品详情" class="headerlink" title="7.1.   商品详情"></a>7.1.   商品详情</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">product.html 获取地址中的商品id，然后根据id获取商品详情</span><br><span class="line">1.获取地址参数</span><br><span class="line">	a.解析地址参数数据</span><br><span class="line">	var search = location.search.slice(1);</span><br><span class="line">	var arr = search.split(&apos;&amp;&apos;);</span><br><span class="line">	var obj = &#123;&#125;;</span><br><span class="line">	arr.forEach(function(item)&#123;</span><br><span class="line">        var temp = item.split(&apos;=&apos;);</span><br><span class="line">        console.log(temp[0]);</span><br><span class="line">        console.log(temp[1]);</span><br><span class="line">        obj[temp[0]] = temp[1];</span><br><span class="line">	&#125;);</span><br><span class="line">2.发送请求</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url:&apos;/api/product/queryProductDetail&apos;,</span><br><span class="line">    type:&apos;get&apos;,</span><br><span class="line">    data:&#123;id: obj.id&#125;,</span><br><span class="line">    success:function(info)&#123;</span><br><span class="line">        console.log(info);</span><br><span class="line">        将info.size中的数据，分割成数组 </span><br><span class="line">        info.size = info.size.split(&apos;-&apos;);</span><br><span class="line">        计算折扣：</span><br><span class="line">        toFixed(1):保留几位小数点</span><br><span class="line">        info.discount = (info.price/info.oldPrice*10).toFixed(1);</span><br><span class="line">        调用模板引擎</span><br><span class="line">        var html = template(&apos;template&apos;,info);</span><br><span class="line">        $(&apos;#detail&apos;).html(html);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;);</span><br><span class="line">3.处理json数据</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">定义模板引擎</span><br><span class="line">只有一条数据，不需要遍历</span><br><span class="line">&lt;script type=&quot;text/html&quot; id=&quot;template&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;cz_banner mui-slider&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;mui-slider-group mui-slider-loop&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;mui-slider-item mui-slider-item-duplicate&quot;&gt;</span><br><span class="line">                    &lt;a href=&quot;#&quot;&gt;&lt;img src=&quot;images/product.jpg&quot;&gt;&lt;/a&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;mui-slider-item mui-active&quot;&gt;</span><br><span class="line">                    &lt;a href=&quot;#&quot;&gt;&lt;img src=&quot;images/product.jpg&quot;&gt;&lt;/a&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;mui-slider-item mui-active&quot;&gt;</span><br><span class="line">                    &lt;a href=&quot;#&quot;&gt;&lt;img src=&quot;images/product.jpg&quot;&gt;&lt;/a&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;mui-slider-item mui-slider-item-duplicate&quot;&gt;</span><br><span class="line">                    &lt;a href=&quot;#&quot;&gt;&lt;img src=&quot;images/product.jpg&quot;&gt;&lt;/a&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;mui-slider-indicator&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;mui-indicator mui-active&quot;&gt;&lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;mui-indicator&quot;&gt;&lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;p_title&quot;&gt;</span><br><span class="line">            &#123;&#123;proName&#125;&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;p_price&quot;&gt;</span><br><span class="line">            &lt;span class=&quot;fold&quot;&gt;&lt;span&gt;&#123;&#123;discount&#125;&#125;&lt;/span&gt;折&lt;/span&gt;</span><br><span class="line">            价格：&lt;strong class=&quot;present&quot;&gt;¥</span><br><span class="line">            &#123;&#123;price&#125;&#125;&lt;/strong&gt;</span><br><span class="line">            &lt;del class=&quot;original&quot;&gt;¥&#123;&#123;oldPrice&#125;&#125;&lt;/del&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;p_size&quot;&gt;</span><br><span class="line">            尺码：</span><br><span class="line">            &#123;&#123;each size val&#125;&#125;</span><br><span class="line">            	&lt;span class=&quot;btn_size&quot;&gt;&#123;&#123;val&#125;&#125;&lt;/span&gt;</span><br><span class="line">            &#123;&#123;/each&#125;&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;p_number&quot;&gt;</span><br><span class="line">            数量：</span><br><span class="line">            &lt;span class=&quot;jian btn_act&quot;&gt;-&lt;/span&gt;</span><br><span class="line">            &lt;input type=&quot;tel&quot; class=&quot;btn_num&quot; value=&quot;1&quot; /&gt;</span><br><span class="line">            &lt;span class=&quot;jia btn_act&quot;&gt;+&lt;/span&gt;</span><br><span class="line">            剩余：&#123;&#123;num&#125;&#125; 件</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;p_detail&quot;&gt;</span><br><span class="line">            &lt;img data-lazyload=&quot;images/detail.jpg&quot;  alt=&quot;&quot;/&gt;</span><br><span class="line">            &lt;img data-lazyload=&quot;images/detail.jpg&quot;  alt=&quot;&quot;/&gt;</span><br><span class="line">            &lt;img data-lazyload=&quot;images/detail.jpg&quot;  alt=&quot;&quot;/&gt;</span><br><span class="line">            &lt;img data-lazyload=&quot;images/detail.jpg&quot;  alt=&quot;&quot;/&gt;</span><br><span class="line">            &lt;img data-lazyload=&quot;images/detail.jpg&quot;  alt=&quot;&quot;/&gt;</span><br><span class="line">            &lt;img data-lazyload=&quot;images/detail.jpg&quot;  alt=&quot;&quot;/&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">删除除轮播图和区域滚动以外的js插件, 上拉刷新  图片懒加载</span><br></pre></td></tr></table></figure>
<h3 id="7-2-添加购物车"><a href="#7-2-添加购物车" class="headerlink" title="7.2  添加购物车"></a>7.2  添加购物车</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">修改produce.html中的购物车按钮，跳转到/cart.html</span><br><span class="line">点击购物车添加购物车：</span><br><span class="line">	1.添加点击事件</span><br><span class="line">		获取商品信息</span><br><span class="line">	2.发送ajax请求</span><br><span class="line">	$(&apos;.btn_addCart&apos;).on(&apos;click&apos;,function()&#123;</span><br><span class="line">		获取商品信息  数量</span><br><span class="line">		var num = $(&apos;.btn_count&apos;).val();</span><br><span class="line">		var size = $(&apos;span.active&apos;).text();</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            url: &apos;/api/cart/addCart&apos;,</span><br><span class="line">            type:&apos;post&apos;,</span><br><span class="line">            data:&#123;</span><br><span class="line">                productId:obj.id,</span><br><span class="line">                num:num,</span><br><span class="line">                size: 40</span><br><span class="line">            &#125;</span><br><span class="line">            success:function(info)&#123;</span><br><span class="line">                console.log(info);</span><br><span class="line">                if(info.error)&#123;</span><br><span class="line">                    return mui.alert(</span><br><span class="line">                        &apos;请先登录&apos;,</span><br><span class="line">                        &apos;提示&apos;,</span><br><span class="line">                        &apos;确认&apos;,</span><br><span class="line">                        function()&#123;</span><br><span class="line">                            location.href = &apos;/user/login.html?url=&apos;+location.href;</span><br><span class="line">                        &#125;</span><br><span class="line">                    );</span><br><span class="line">                &#125;</span><br><span class="line">                mui.toast(&apos;添加成功&apos;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">	&#125;);</span><br><span class="line">选择型号:由于元素是动态添加的不能直接给元素添加事件，通过实践委托来实现</span><br><span class="line"> // 获取型号</span><br><span class="line"> $(&apos;#detail&apos;).on(&apos;click&apos;, &apos;.btn_size&apos;, function () &#123;</span><br><span class="line"> 	$(this).addClass(&apos;active&apos;).siblings().removeClass(&apos;active&apos;);</span><br><span class="line"> &#125;)</span><br><span class="line"></span><br><span class="line">// 修改商品数量</span><br><span class="line">$(&apos;#detail&apos;).on(&apos;click&apos;, &apos;.btn_act&apos;, function () &#123;</span><br><span class="line">    // 获取数量</span><br><span class="line">    var input = $(this).siblings(&apos;input&apos;);</span><br><span class="line">    var n = input.val()-0;  转数字</span><br><span class="line"></span><br><span class="line">    if($(this).is(&apos;.jia&apos;)) &#123;</span><br><span class="line">    // 加</span><br><span class="line">    	如果n的值大于库存的值，return</span><br><span class="line">    	if(n &gt;= $(&apos;.btn_total&apos;).text()-0) return;</span><br><span class="line">    	return input.val(++n);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 减</span><br><span class="line">    if(n &lt;= 1) return;</span><br><span class="line">    input.val(--n);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">注意：如果商品数量手动修改的话，添加失去焦点事件</span><br></pre></td></tr></table></figure>
<h3 id="7-3-购物车列表"><a href="#7-3-购物车列表" class="headerlink" title="7.3  购物车列表"></a>7.3  购物车列表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">cart.html</span><br><span class="line">获取购物车列表</span><br><span class="line">1.发送ajax请求</span><br><span class="line">2.等待响应</span><br><span class="line">3.处理json数据</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url:&apos;/api/cart/queryCart&apos;,</span><br><span class="line">    type:&apos;get&apos;,</span><br><span class="line">    data:&#123;id: obj.id&#125;,</span><br><span class="line">    success:function(info)&#123;</span><br><span class="line">        console.log(info);</span><br><span class="line">        if(info.error)&#123;</span><br><span class="line">            return mui.alert(</span><br><span class="line">                &apos;请先登录&apos;,</span><br><span class="line">                &apos;提示&apos;,</span><br><span class="line">                &apos;确认&apos;,</span><br><span class="line">                function()&#123;</span><br><span class="line">                	location.href = &apos;/user/login.html?url=&apos;+location.href;</span><br><span class="line">                &#125;</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">        var html = template(&apos;template&apos;,&#123;lists:info&#125;);</span><br><span class="line">        $(&apos;#cart&apos;).html(html);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">模板引擎</span><br></pre></td></tr></table></figure>
<h2 id="8-分类"><a href="#8-分类" class="headerlink" title="8.  分类"></a>8.  分类</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cate.html</span><br><span class="line">获取分类</span><br><span class="line">1.发送请求获取顶级分类</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    </span><br><span class="line">&#125;);</span><br><span class="line">2.处理顶级分类数据</span><br><span class="line">3.点击顶级分类，获取相应的二级分类</span><br><span class="line">4.处理二级分类数据</span><br></pre></td></tr></table></figure>
<h3 id="8-1-分类"><a href="#8-1-分类" class="headerlink" title="8.1.  分类"></a>8.1.  分类</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">发送ajax请求，获取一级二级分类</span><br><span class="line">&lt;!-- 自定义顶级分类模板 --&gt;</span><br><span class="line">&lt;script type=&quot;text/html&quot; id=&quot;topTpl&quot;&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">        &#123;&#123;each rows val&#125;&#125;</span><br><span class="line">        	&lt;li data-id=&quot;&#123;&#123;val.id&#125;&#125;&quot;&gt;&#123;&#123;val.categoryName&#125;&#125;&lt;/li&gt;</span><br><span class="line">        &#123;&#123;/each&#125;&#125;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;!-- 自定义二级分类模板 --&gt;</span><br><span class="line">&lt;script type=&quot;text/html&quot; id=&quot;childTpl&quot;&gt;</span><br><span class="line">    &lt;span class=&quot;title&quot;&gt;&#123;&#123;text&#125;&#125;&lt;/span&gt;</span><br><span class="line">    &lt;ul class=&quot;mui-clearfix&quot;&gt;</span><br><span class="line">        &#123;&#123;each rows val&#125;&#125;</span><br><span class="line">            &lt;li&gt;</span><br><span class="line">                &lt;a href=&quot;javascript:;&quot;&gt;</span><br><span class="line">                	&lt;img src=&quot;/api&#123;&#123;val.brandLogo&#125;&#125;&quot; alt=&quot;&quot;/&gt;</span><br><span class="line">                	&lt;p&gt;&#123;&#123;val.brandName&#125;&#125;&lt;/p&gt;</span><br><span class="line">                &lt;/a&gt;</span><br><span class="line">            &lt;/li&gt;</span><br><span class="line">        &#123;&#123;/each&#125;&#125;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">发送ajax请求</span><br><span class="line">// 获取分类</span><br><span class="line">// 1. 发送请求获取顶（一）级分类</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url: &apos;/api/category/queryTopCategory&apos;,</span><br><span class="line">    type: &apos;get&apos;,</span><br><span class="line">    success: function (info) &#123;</span><br><span class="line">        // 2. 处理顶（一）级分类数据</span><br><span class="line">        console.log(info);</span><br><span class="line"></span><br><span class="line">        // 调用模板引擎</span><br><span class="line">        var html = template(&apos;topTpl&apos;, info);</span><br><span class="line">        // 添加DOM</span><br><span class="line">        $(&apos;#top&apos;).html(html);</span><br><span class="line"></span><br><span class="line">        // 添加默认数据</span><br><span class="line">        $(&apos;#top li:first-child&apos;).trigger(&apos;click&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">        </span><br><span class="line">// 3. 再次点击顶（一）级分类，获取相应的二级分类</span><br><span class="line">$(&apos;#top&apos;).on(&apos;click&apos;, &apos;li&apos;, function () &#123;</span><br><span class="line">    // 获取顶级分类id</span><br><span class="line">    var id = $(this).attr(&apos;data-id&apos;);</span><br><span class="line">    // 顶级分类名称</span><br><span class="line">    var text = $(this).text();</span><br><span class="line"></span><br><span class="line">    // 改变顶级分类的样式</span><br><span class="line">    $(this).addClass(&apos;now&apos;).siblings().removeClass(&apos;now&apos;);</span><br><span class="line"></span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url: &apos;/api/category/querySecondCategory&apos;,</span><br><span class="line">        type: &apos;get&apos;,</span><br><span class="line">        data: &#123;id: id&#125;,</span><br><span class="line">            success: function (info) &#123;</span><br><span class="line">            // 4. 处理二级分类数据</span><br><span class="line">            console.log(info);</span><br><span class="line">            // 顶级分类名称</span><br><span class="line">            info.text = text;</span><br><span class="line">            // 调用模板引擎</span><br><span class="line">            var html = template(&apos;childTpl&apos;, info);</span><br><span class="line">            // 添加DOM</span><br><span class="line">            $(&apos;#child&apos;).html(html);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="8-1-上拉加载"><a href="#8-1-上拉加载" class="headerlink" title="8.1.  上拉加载"></a>8.1.  上拉加载</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">上拉取数据</span><br><span class="line">&lt;!-- 自定义购物车模板 --&gt;</span><br><span class="line">&lt;script type=&quot;text/html&quot; id=&quot;tpl&quot;&gt;</span><br><span class="line">    &#123;&#123;each data val&#125;&#125;</span><br><span class="line">        &lt;li data-product=&quot;&quot; class=&quot;mui-table-view-cell&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;mui-slider-right mui-disabled&quot;&gt;</span><br><span class="line">                &lt;a class=&quot;mui-btn mui-btn-blue&quot;&gt;编辑&lt;/a&gt;</span><br><span class="line">                &lt;a class=&quot;mui-btn mui-btn-red&quot;&gt;删除&lt;/a&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        	&lt;a href=&quot;javascript:;&quot; class=&quot;mui-navigate-right mui-slider-handle&quot;&gt;</span><br><span class="line">                &lt;img class=&quot;mui-media-object mui-pull-left&quot; src=&quot;/api&#123;&#123;val.pic[0].picAddr&#125;&#125;&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;mui-media-body&quot;&gt;</span><br><span class="line">                    &lt;p class=&quot;name&quot;&gt;&#123;&#123;val.proName&#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;p class=&quot;info&quot;&gt;</span><br><span class="line">                    &lt;span class=&quot;price&quot;&gt;&amp;yen;&#123;&#123;val.price&#125;&#125;&lt;/span&gt;</span><br><span class="line">                    &lt;span class=&quot;oldPrice&quot;&gt;&amp;yen;&#123;&#123;val.oldPrice&#125;&#125;&lt;/span&gt;</span><br><span class="line">                    &lt;span class=&quot;number&quot;&gt;x&#123;&#123;val.num&#125;&#125;&lt;/span&gt;</span><br><span class="line">                    &lt;/p&gt;</span><br><span class="line">                    &lt;p&gt;&lt;span class=&quot;size&quot;&gt;鞋码：&#123;&#123;val.size&#125;&#125;&lt;/span&gt;&lt;/p&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;input type=&quot;checkbox&quot;/&gt;</span><br><span class="line">            &lt;/a&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">    &#123;&#123;/each&#125;&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 初始化变量</span><br><span class="line">var page = 1;</span><br><span class="line">var pageSize = 5;</span><br><span class="line"></span><br><span class="line">mui(function()&#123;</span><br><span class="line">    mui.init(&#123;</span><br><span class="line">        pullRefresh : &#123;</span><br><span class="line">            container: &quot;.cz_container&quot;,</span><br><span class="line">            down: &#123;</span><br><span class="line">                height: 50,</span><br><span class="line">                auto: true,</span><br><span class="line">                contentdown: &quot;下拉可以刷新&quot;,</span><br><span class="line">                contentover: &quot;释放立即刷新&quot;,</span><br><span class="line">                contentrefresh: &quot;正在刷新...&quot;,</span><br><span class="line">                callback: function () &#123;</span><br><span class="line">                    $.ajax(&#123;</span><br><span class="line">                        url: &apos;/api/cart/queryCartPaging&apos;,</span><br><span class="line">                        type: &apos;get&apos;,</span><br><span class="line">                        data: &#123;</span><br><span class="line">                            // 刷新永远为第1页</span><br><span class="line">                            page: 1,</span><br><span class="line">                            pageSize: pageSize</span><br><span class="line">                        &#125;,</span><br><span class="line">                        success: function (info) &#123;</span><br><span class="line">                            // console.log(info);</span><br><span class="line">                            // 调用模板引擎</span><br><span class="line">                            var html = template(&apos;tpl&apos;, info);</span><br><span class="line">                            // 添加DOM</span><br><span class="line">                            $(&apos;#cart&apos;).html(html);</span><br><span class="line"></span><br><span class="line">                            // 当请求完成时需要手动</span><br><span class="line">                            // 终止请求（官方文档有误）</span><br><span class="line">                            mui(&apos;.cz_container&apos;).pullRefresh().endPulldownToRefresh();</span><br><span class="line"></span><br><span class="line">                            // 下拉刷新后将页码重置为1</span><br><span class="line">                            page = 1;</span><br><span class="line">                            mui(&apos;.cz_container&apos;).pullRefresh().enablePullupToRefresh();</span><br><span class="line">                         &#125;</span><br><span class="line">            		&#125;);</span><br><span class="line">            	&#125;</span><br><span class="line">        	&#125;,</span><br><span class="line">        up: &#123;</span><br><span class="line">            height: 50,</span><br><span class="line">            auto: false,</span><br><span class="line">            contentrefresh: &quot;正在加载...&quot;,</span><br><span class="line">            contentnomore: &apos;没有更多数据了&apos;,</span><br><span class="line">            callback: function () &#123;</span><br><span class="line">                page++;</span><br><span class="line">                // 发送请求请求更多数据</span><br><span class="line">                $.ajax(&#123;</span><br><span class="line">                    url: &apos;/api/cart/queryCartPaging&apos;,</span><br><span class="line">                    type: &apos;get&apos;,</span><br><span class="line">                    data: &#123;</span><br><span class="line">                        page: page,</span><br><span class="line">                        pageSize: pageSize</span><br><span class="line">                    &#125;,</span><br><span class="line">                    success: function (info) &#123;</span><br><span class="line">                        console.log(info);</span><br><span class="line">                        // 终止上拉交互</span><br><span class="line">                        if(info.length == 0) &#123;</span><br><span class="line">                            mui(&apos;.cz_container&apos;).pullRefresh().endPullupToRefresh(true);</span><br><span class="line">                            return;</span><br><span class="line">                        &#125;</span><br><span class="line">                         // 调用模板引擎</span><br><span class="line">                         var html = template(&apos;tpl&apos;, info);</span><br><span class="line">                         // 一定追加</span><br><span class="line">                         $(&apos;#cart&apos;).append(html);</span><br><span class="line">                        // 手动终止请求</span><br><span class="line">                        mui(&apos;.cz_container&apos;).pullRefresh().endPullupToRefresh();</span><br><span class="line">                	&#125;</span><br><span class="line">                &#125;)</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2 id="9-后端登录"><a href="#9-后端登录" class="headerlink" title="9.  后端登录"></a>9.  后端登录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">进入后台首页，判断有没有登录，没登陆跳转到登录页</span><br><span class="line">1.检测用户登录</span><br><span class="line">// 检测用户登录</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">	url: &apos;/api/employee/checkRootLogin&apos;,</span><br><span class="line">	type: &apos;get&apos;,</span><br><span class="line">	success: function (info) &#123;</span><br><span class="line">		if(info.error) location.href = &apos;/admin/login.html&apos;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line">2.登录页面</span><br><span class="line">// 获取地址参数</span><br><span class="line">var search = location.search.slice(1);</span><br><span class="line">// 使用正则匹配 url 参数的值</span><br><span class="line">var reg = /url=(.+)/;</span><br><span class="line">// 匹配到的地址</span><br><span class="line">var match = reg.exec(search);</span><br><span class="line">var url = match &amp;&amp; match[1];</span><br><span class="line">url = url || &apos;/admin&apos;;</span><br><span class="line">$(&apos;form&apos;).on(&apos;submit&apos;, function () &#123;</span><br><span class="line">        // 1. 获取用户表单填写的信息</span><br><span class="line">        var data = $(this).serialize();</span><br><span class="line">        // 2. 发送请求至服务端</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            url: &apos;/api/employee/employeeLogin&apos;,</span><br><span class="line">            type: &apos;post&apos;,</span><br><span class="line">            data: data,</span><br><span class="line">            success: function (info) &#123;</span><br><span class="line">                // 3. 待待响应结果</span><br><span class="line">                console.log(info);</span><br><span class="line">                if(info.success) &#123;</span><br><span class="line">                	return location.href = url;</span><br><span class="line">                &#125;</span><br><span class="line">                // 提示错误</span><br><span class="line">                alert(info.message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">	return false;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="9-1-后台退出登录"><a href="#9-1-后台退出登录" class="headerlink" title="9.1  后台退出登录"></a>9.1  后台退出登录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 退出登录</span><br><span class="line">$(&apos;.fa-sign-out&apos;).parent().on(&apos;click&apos;, function () &#123;</span><br><span class="line">	// 发送请求</span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url: &apos;/api/employee/employeeLogout&apos;,</span><br><span class="line">		type: &apos;get&apos;,</span><br><span class="line">		success: function (info) &#123;</span><br><span class="line">			if(info.success) &#123;</span><br><span class="line">				location.href = &apos;/admin/login.html?url=&apos; + location.href;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="10-后台用户列表"><a href="#10-后台用户列表" class="headerlink" title="10.  后台用户列表"></a>10.  后台用户列表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">// 获取用户列表</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url: &apos;/api/user/queryUser&apos;,</span><br><span class="line">    type: &apos;get&apos;,</span><br><span class="line">    data: &#123;</span><br><span class="line">        page: 1,</span><br><span class="line">        pageSize: 100</span><br><span class="line">    &#125;,</span><br><span class="line">    success: function (info) &#123;</span><br><span class="line">        console.log(info);</span><br><span class="line">        // 调用模板引擎</span><br><span class="line">        var html = template(&apos;tpl&apos;, info);</span><br><span class="line">        // 添加DOM</span><br><span class="line">        $(&apos;tbody&apos;).html(html);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">模板引擎</span><br><span class="line">&lt;script type=&quot;text/html&quot; id=&quot;tpl&quot;&gt;</span><br><span class="line">    &#123;&#123;each rows val key&#125;&#125;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;&#123;&#123;key+1&#125;&#125;&lt;/td&gt;    因为使用id删除数据后编号不是连续的</span><br><span class="line">            &lt;td&gt;&#123;&#123;val.username&#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&#123;&#123;val.mobile&#125;&#125;&lt;/td&gt;</span><br><span class="line">            &#123;&#123;if(val.isDelete == 0)&#125;&#125;</span><br><span class="line">            	&lt;td&gt;是&lt;/td&gt;</span><br><span class="line">            &#123;&#123;else&#125;&#125;</span><br><span class="line">            	&lt;td&gt;否&lt;/td&gt;</span><br><span class="line">            &#123;&#123;/if&#125;&#125;</span><br><span class="line">            &lt;td data-id=&quot;&#123;&#123;val.id&#125;&#125;&quot; data-status=&#123;&#123;val.isDelete&#125;&#125;&gt;</span><br><span class="line">                &#123;&#123;if(val.isDelete == 0)&#125;&#125;</span><br><span class="line">                	&lt;a href=&quot;javascript:;&quot; class=&quot;btn btn-info btn-xs&quot;&gt;启 用&lt;/a&gt;</span><br><span class="line">                &#123;&#123;else&#125;&#125;</span><br><span class="line">                	&lt;a href=&quot;javascript:;&quot; class=&quot;btn btn-warning btn-xs&quot;&gt;禁 用&lt;/a&gt;</span><br><span class="line">                &#123;&#123;/if&#125;&#125;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &#123;&#123;/each&#125;&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h1 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h1><h3 id="相对路径和绝对路径"><a href="#相对路径和绝对路径" class="headerlink" title="相对路径和绝对路径"></a>相对路径和绝对路径</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.凡是以./或者是../开头的都叫相对路径</span><br><span class="line">2.在window系统中，凡是以盘符开头的都叫绝对路径  c:\admin</span><br><span class="line">3.在linux或者是MAC系统中，凡是以/开头的都叫绝对路径  </span><br><span class="line">4.在网络环境中，凡是以http://域名：端口号/a/b/c开头的叫绝对路径</span><br><span class="line">http://letao.com 可以被简写成 /</span><br><span class="line">http://letao.com/a/b  可以被简写成 /a/b</span><br><span class="line">http://letao.com/api/user/login  可以被简写成 /api/user/login</span><br></pre></td></tr></table></figure>
<h3 id="保留几位小数点"><a href="#保留几位小数点" class="headerlink" title="保留几位小数点"></a>保留几位小数点</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var num = 123.456;</span><br><span class="line">num.toFixed(1);  保留一位小数点</span><br></pre></td></tr></table></figure>
<h3 id="字符串的数字相比较"><a href="#字符串的数字相比较" class="headerlink" title="字符串的数字相比较"></a>字符串的数字相比较</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">如果是字符串的数字相比较,先比较第一位数字，第一位大的就大</span><br><span class="line">&apos;3&apos;  &gt;  &apos;20&apos;</span><br></pre></td></tr></table></figure>
      </div>
        <div class="support-author">
          <p>感谢您的阅读。 🙏
          <a href target="_blank">关于转载请看这里</a>
            <!--<a class="btn-pay"  href="#pay-modal">¥ 打赏支持</a>-->
          </p>
        </div>
        <!--
            <div class="like ">
              <div class="like-button">
                <a id="like-note" href="">
                  <i class="icon-heart"></i>喜欢
                </a>
              </div>
              <span id="likes-count">256</span>
            </div>
        -->
        <div class="otherLink">
          <div class="previous">
          </div>
          <div class="next">
          </div>
        </div>
        <div class="comments" id="comments">
          
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script type="text/javascript">
  const gitalk = new Gitalk({
    clientID: '8888a8888',
    clientSecret: '8888886666666',
    repo: 'xxxx.github.io',
    owner: 'admin',
    admin: ['admin'],
    id: location.pathname,      // Ensure uniqueness and length less than 50
    distractionFreeMode: false
  })

  gitalk.render('comments');
</script>


        </div>
      </div>
    </div>
   
</main>
<div class="footer">
  <div class="info">
    <p>
    <a href="https://hexo.io"> Hexo </a> 强力驱动 |
      <a href="https://github.com/Youthink/hexo-themes-yearn"> Yearn </a>
      主题
    </p>
    <p>&copy;2013-2018 Ren Fang的博客 京ICP备xxxxxx号</p>
  </div>
</div>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script>//console
  var consoleConfig = '\n欢迎访问 https://hufangyun.com ，围观小猿大圣的博客(づ｡◕‿‿◕｡)づ！\n,\n本博客使用 %cHexo%c 搭建，博客主题为小猿大圣开发的 %chexo-themes-yearn%c ~~~ 🎉🎉🎉 \n\n源码 https://github.com/Youthink/hexo-themes-yearn \n\n如果喜欢可以 star 支持一下 ❤️~\n'.split(',');
  var canConsole = true;
  var consoleInfo = (function(consoleConfig) {
  if (!canConsole || !consoleConfig || consoleConfig.length < 1) {
    return;
  }
  var consoleColor = '#6190e8';
  var _console;
  var backgroundTextStyle = 'padding: 1px 5px;color: #fff;background: ' + consoleColor + ';'
  var textStyle = 'color: ' + consoleColor + ';';

  consoleConfig.map(o => {
    var num = (o.match(/%c/g) || []).length;
    if(/^http(s)?:\/\//.test(o)) {
      console.log('%c     ', 'background: url(' + o + ') no-repeat left center;font-size: 180px;');
      return;
    }
    if (num > 0) {
      var logArguments = [];
      for (var i = 0; i < num; i++) {
        if (i % 2 === 0) {
          logArguments.push(backgroundTextStyle);
        } else {
          logArguments.push(textStyle);
        }
      }
      (_console = console).log.apply(_console, ['%c' + o, textStyle].concat(logArguments));
      return;
    }
    console.log('%c' + o, textStyle);
  });
}(consoleConfig));</script><script type="text/javascript" src="/songfang0/./js/main.d9e3dd.js"></script>

</body>
</html>
